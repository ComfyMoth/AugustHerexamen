[Presentatie](https://learning.ap.be/pluginfile.php/1957793/mod_resource/content/1/05%20-%20Theorie%20-%20Transportlaag%20%281%29.pdf)
# Transportlaag
- Steunt op de diensten van de netwerklaag (communicatie tussen hosts)
- Voegt extra functionaliteiten toe aan de diensten van de netwerklaag
- <span style="color:#c8ab83;">Logische communicatie</span> tussen processen op verschillende hosts die met mekaar communiceren
- Transport protocols zijn geïmplementeerd in de end-systemen die met mekaar communiceren
	- Zender: Boodschappen opdelen in <span style="color:#c8ab83;">segmenten</span> + doorgeven aan de netwerklaag
	- Ontvanger: segmenten samenvoegen en boodschap doorgeven aan applicatielaag

# Transportlaag protocollen
- Betrouwbare, in-volgorde aflevering: <span style="color:#c8ab83;">TCP</span> (Transmission Control Protocol)
	- <span style="color:#c8ab83;">Connection setup</span>
	-> opzetten van een verbinding vooraleer data te verzenden
	- <span style="color:#c8ab83;">Error control</span>
	-> Detectiemechanismen om fouten in de headers + payloads op te sporen
	- <span style="color:#c8ab83;">Retransmissie</span>
	-> Herzending van corrupte of niet-toegekomen segmenten
	- <span style="color:#c8ab83;">Flow control</span>
	->Mechanismen om de zendsnelheid te begrenzen conform de capaciteiten van de ontvanger
	- <span style="color:#c8ab83;">Congestion control</span>
	-> Mechanismen om de zendsnelheid te begrenzen conform de capaciteiten van het netwerk
- Onbetrouwbaar, niet-in-volgorde aflevering: <span style="color:#c8ab83;">UDP</span> (User Datagram Protocol)
	- <span style="color:#c8ab83;">Error control</span>

# Multiplexing - Demultiplexing
<span style="color:#c8ab83;">Demultiplexing (ontvanger)</span>:
	Segmenten bij de juiste socket afleveren

<span style="color:#c8ab83;">Multiplexing (zender)</span>
	Data van verschillende sockets verpakken tot segmenten met juiste headerinfo

![[Pasted image 20240709171605.png]]

## Hoe werkt demultiplexing
<span style="color:#c8ab83;">Host ontvangt IP datagrams</span>
- elk datagram bevat een bron IP adres en een bestemmings IP adres
- elk datagram bevat een transport-laag segment
- elk segment bevat een bron poort en een bestemmings poort

<span style="color:#c8ab83;">Host gebruikt IP adressen & poort nummers om het segment bij de juiste socket af te leveren</span>
![[Pasted image 20240709171809.png]]

**Connectie georienteerd**
- TCP socket wordt bepaald door 4 parameters
	- <span style="color:#c8ab83;">Bron IP</span>
	- <span style="color:#c8ab83;">Bron poort</span>
	- <span style="color:#c8ab83;">Bestemmings IP</span>
	- <span style="color:#c8ab83;">Bestemmings poort</span>
- Ontvanger gebruikt alle 4 de parameters om éénduidig 1 socket te identificeren

**Connectieloos**
- UDP socket wordt bepaald door twee parameters
	- <span style="color:#c8ab83;">Bestemmings IP</span>
	- <span style="color:#c8ab83;">Bestemmings poort</span>
- IP datagrammen met verschillende bron IP's en bron porten kunnen bij dezelfde ontvangende socket terechtkomen

# UDP - User Datagram Protocol
- <span style="color:#c8ab83;">Best effort</span>: segement kunnen verloren gaan
- <span style="color:#c8ab83;">Connectieloos</span>: Geen connectie setup tussen zender en ontvanger
	-> Elk UDP segment wordt onafhankelijk van de andere behandeld

**Bestaansreden voor UDP?** 
- Geen connectie setup (dus <span style="color:#c8ab83;">minder vertraging</span>)
- <span style="color:#c8ab83;">Simpel</span>: er wordt geen status bijgehouden, noch bij zender, noch bij ontvanger
- Kleine segment header (dus <span style="color:#c8ab83;">minder overhead</span>)
- Geen flow en congestion control (UDP kan verzenden zo snel als het voor de zender kan en hoet zich niets aan te trekken van de capaciteiten van de ontvanger of van het netwerk)

- Vaak gebruikt voor streaming apps
	- verlies-tolerant
	- snelheidsgevoelig
- Andere gebruiken
	- DNS
	- SNMP
- Betrouwbaarheid moet ingebouwd worden op applicatie-niveau

# TCP - Transmission Control Protocol
- <span style="color:#c8ab83;">point-to-point</span>:
	- 1 zender, 1 ontvanger
- <span style="color:#c8ab83;">reliabe, in-volgorde byte stream service</span>:
	- Negeert grenzen van boodschappen van de app
- <span style="color:#c8ab83;">pipelined</span>:
	- TCP congestion and flow control set window size
- <span style="color:#c8ab83;">Zend en ontvang buffers</span>:
	- Zendbuffers om reeds verzonden opnieuw te kunnen terughalen als herzending nodig is
	- Ontvangbuffers om ontvangen segmenten te stockeren en ze te processen alvorens ze door te geven aan de applicatielaag
- <span style="color:#c8ab83;">Full duplex data-transfer</span>:
- <span style="color:#c8ab83;">Connection-oriented</span>:
	- Verbinding op voorhand opzetten
	- 3-way handshake setup
- <span style="color:#c8ab83;">flow-control</span>:
	- Capaciteiten van ontvanger respecteren
- <span style="color:#c8ab83;">congestion control</span>
	- Capaciteiten van het netwerk respecteren

## TCP - Segment formaat
**U**: urgent flag = 1 -> Moet onmiddelijk beantwoord worden.
**A**: Ack = 1 -> ACK nr geeft weer tot hoever datastroom correct ontvangen
**P**: push = 1 -> segment onmiddelijk doorgeven aan hogergelegen applicatie
**R**: reset = 1 -> reset de verbinding
**S**: SYN = 1 -> opzetten en synchroniseren van een verbinding
**F**: FIN = 1 -> Verbinding afbreken